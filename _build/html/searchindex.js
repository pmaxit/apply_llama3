Search.setIndex({"docnames": ["README", "intro", "markdown", "markdown-notebooks", "nbs/Finetuning-Large Language-models", "nbs/Untitled", "nbs/finetuning_accelerate", "nbs/finetuning_sequenceclassification", "nbs/notebooks", "src/image_classifiers/cifar10", "src/image_classifiers/image_classification", "src/image_classifiers/imagenette", "src/random/batch_norm", "src/random/lrschedule", "src/text_classification/classification"], "filenames": ["README.md", "intro.md", "markdown.md", "markdown-notebooks.md", "nbs/Finetuning-Large Language-models.ipynb", "nbs/Untitled.ipynb", "nbs/finetuning_accelerate.ipynb", "nbs/finetuning_sequenceclassification.ipynb", "nbs/notebooks.ipynb", "src/image_classifiers/cifar10.ipynb", "src/image_classifiers/image_classification.ipynb", "src/image_classifiers/imagenette.ipynb", "src/random/batch_norm.ipynb", "src/random/lrschedule.ipynb", "src/text_classification/classification.ipynb"], "titles": ["apply_llama3", "Welcome to the book on applying LLAMA 3", "Markdown Files", "Notebooks with MyST Markdown", "Finetuning large language models", "&lt;no title&gt;", "Tokenizer", "Finetuning large language models", "Content with notebooks", "Load the dataset", "&lt;no title&gt;", "Transforms", "Understanding BatchNorm with PyTorch Lightning: A Hands-on Tutorial", "Testing LR schedule", "Tokenizer"], "terms": {"here": [0, 1, 2, 4, 5, 8, 9, 12], "book": [0, 2, 3, 5, 8], "http": [0, 4], "pmaxit": 0, "github": 0, "io": [0, 4], "intro": 0, "html": [0, 4, 8], "thi": [1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 14], "an": [1, 2, 4, 5, 7, 10, 12], "introduct": 1, "framework": 1, "how": [1, 3, 4, 12], "variou": [1, 4, 5], "busi": [1, 4], "usecas": 1, "It": [1, 2, 4, 5, 12], "intend": 1, "profession": 1, "research": [1, 4, 5], "who": 1, "ar": [1, 2, 3, 4, 5, 6, 7, 9, 11, 12, 14], "new": [1, 4, 5, 7, 14], "want": [1, 4, 7, 8, 14], "learn": [1, 5, 6, 12, 13], "us": [1, 2, 3, 4, 6, 7, 9, 10, 11, 12, 14], "handl": 1, "practic": 1, "also": [1, 2, 3, 4, 5, 8], "those": [1, 2], "alreadi": [1, 4, 5, 10], "familiar": 1, "more": [1, 3, 4, 6, 7, 8, 12], "about": [1, 2, 3, 4, 5, 8], "own": [1, 5], "organ": 1, "follow": [1, 2, 3, 4], "chapter": [1, 4], "1": [1, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14], "2": [1, 3, 4, 5, 6, 7, 9, 10, 11, 12, 13, 14], "work": [1, 4, 5, 8, 10], "progress": [1, 6], "we": [1, 4, 6, 7, 12], "feedback": 1, "from": [1, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14], "reader": 1, "If": [1, 3, 4, 7, 14], "you": [1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 14], "have": [1, 3, 4, 5, 6, 7, 12], "ani": [1, 3, 4, 5, 14], "question": [1, 4], "suggest": [1, 12], "can": [1, 2, 3, 4, 5, 7, 8, 10, 12, 14], "improv": [1, 4, 10, 12], "pleas": [1, 4, 11], "contact": 1, "your": [1, 2, 3, 4, 5, 8, 12], "data": [1, 4, 6, 7, 8, 9, 10, 12, 14], "cover": 1, "topic": [1, 4], "s": [1, 2, 3, 4, 5, 8, 10, 11, 12], "note": [1, 2, 4, 6], "e": 1, "mc": 1, "markdown": [1, 5], "file": [1, 3, 4, 6, 7, 10, 11], "notebook": [1, 2], "myst": 1, "finetun": [1, 11], "larg": 1, "languag": [1, 2], "model": [1, 5, 6, 10, 13], "understand": [1, 3, 4], "batchnorm": 1, "pytorch": [1, 10, 14], "lightn": [1, 10, 14], "A": [1, 4, 5], "hand": 1, "tutori": 1, "result": [1, 4, 10], "With": [1, 3], "without": [1, 4], "test": [1, 4, 6, 7, 9, 10, 12, 14], "lr": [1, 6, 10, 11, 14], "schedul": [1, 6, 11, 14], "whether": [2, 5], "write": [2, 3], "content": [2, 3, 5], "jupyt": [2, 3, 4, 8], "ipynb": 2, "regular": 2, "md": [2, 3], "ll": [2, 4, 12], "same": [2, 4, 6, 7, 12], "flavor": 2, "call": [2, 4, 6, 7, 10, 11, 14], "simpl": [2, 12], "help": [2, 4, 9, 12], "get": [2, 3, 4, 5, 9, 10, 12], "start": [2, 3, 4, 12], "show": [2, 3, 4, 5, 10, 12], "off": [2, 3], "some": [2, 4, 5, 6, 7, 8, 9, 10, 14], "syntax": 2, "stand": 2, "markedli": 2, "structur": [2, 4], "text": [2, 3, 6, 7, 14], "slight": 2, "variat": 2, "commonmark": 2, "small": [2, 4, 5, 9, 12], "extens": [2, 5], "allow": [2, 4, 12], "sphinx": 2, "ecosystem": 2, "For": [2, 7, 8], "see": [2, 3, 4, 8, 12], "overview": [2, 5], "two": [2, 3, 4, 5, 7], "most": [2, 4, 5, 6, 7, 10, 11], "power": [2, 12], "tool": 2, "thei": [2, 4], "like": [2, 3, 4, 5, 10, 12], "function": [2, 4, 6, 7, 10, 11, 13, 14], "written": [2, 3], "markup": 2, "both": 2, "serv": [2, 5], "similar": [2, 4], "purpos": [2, 4, 9, 12], "one": [2, 4, 5, 6], "line": [2, 3, 5, 6, 7, 8, 10, 11, 13], "wherea": 2, "span": 2, "mani": [2, 3, 4, 5], "accept": [2, 4], "differ": [2, 4, 7], "kind": 2, "input": [2, 4, 6, 7, 11, 12, 14], "do": [2, 4, 5, 6, 8], "depend": [2, 4, 12], "specif": [2, 4, 6, 12], "being": [2, 5], "render": 2, "special": [2, 4, 6, 7], "box": [2, 4], "when": [2, 3, 4, 7, 12, 13, 14], "build": [2, 4, 5], "inlin": 2, "refer": [2, 6, 7, 11, 12, 14], "document": [2, 3, 4, 8], "cite": 2, "store": [2, 4], "bibtex": 2, "exampl": [2, 4, 6, 7, 8, 9, 11, 12, 14], "holdgraf_evidence_2014": 2, "hdhpk14": 2, "moreov": 2, "insert": [2, 6, 7, 12, 14], "bibliographi": 2, "page": [2, 3], "The": [2, 3, 4, 5, 6, 7, 11, 12], "must": [2, 5, 7], "all": [2, 3, 4, 6, 10, 12], "properli": [2, 4], "bib": 2, "christoph": 2, "ramsai": 2, "holdgraf": 2, "wendi": 2, "de": 2, "heer": 2, "brian": 2, "n": [2, 8, 14], "paslei": 2, "robert": 2, "t": [2, 4, 5, 7, 8, 9, 10, 14], "knight": 2, "evid": [2, 4], "predict": [2, 4, 6, 7, 9, 10, 11, 12, 14], "code": [2, 3, 4, 12], "human": 2, "auditori": 2, "cortex": 2, "In": [2, 4, 6, 7, 10, 11, 12], "intern": [2, 12], "confer": 2, "cognit": 2, "neurosci": 2, "brisban": 2, "australia": 2, "2014": 2, "frontier": 2, "just": [2, 4, 5, 6], "starter": 2, "lot": [2, 8], "jupyterbook": 2, "org": [2, 4], "let": [3, 4, 11, 12], "base": [3, 4, 9, 12, 14], "detail": [3, 7], "instruct": [3, 4, 5], "defin": [3, 4, 12], "direct": [3, 4], "so": [3, 4, 7, 10], "print": [3, 4, 5, 6, 7, 9, 10, 11, 12, 13], "built": [3, 5], "block": [3, 7], "execut": 3, "default": [3, 4, 7], "kernel": [3, 7], "output": [3, 4, 6, 9, 10, 11, 14], "displai": 3, "rest": 3, "jupytext": 3, "convert": [3, 4, 9, 10, 11, 12], "support": 3, "other": [3, 4, 5, 7], "thing": [3, 5, 6], "need": [3, 4, 6, 7], "should": [3, 4, 6, 7, 9, 10, 12, 14], "includ": [3, 5, 8, 12], "inform": [3, 4, 6, 7, 8, 14], "top": [3, 5], "presenc": 3, "which": [3, 4, 5, 10, 11, 12], "That": [3, 4], "d": [3, 4, 11], "treat": 3, "run": [3, 6, 7, 12, 14], "command": [3, 4], "init": 3, "path": [3, 5, 12], "markdownfil": 3, "load_ext": [4, 6, 7, 11, 12, 14], "autoreload": [4, 6, 7, 11, 12, 14], "pip": [4, 5], "instal": [4, 5], "langchain": 4, "commun": [4, 5], "transform": [4, 6, 7, 9, 10, 12, 14], "bitsandbyt": 4, "acceler": [4, 6, 7, 10, 12, 14], "openai": 4, "togeth": [4, 5, 6], "import": [4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14], "librari": [4, 12], "dotenv": [4, 5], "os": [4, 5, 6, 7, 10, 12, 14], "panda": [4, 6, 7, 12, 14], "pd": [4, 6, 7, 12, 14], "langchain_cor": 4, "chatprompttempl": 4, "pydantic_v1": 4, "basemodel": 4, "field": 4, "langchain_togeth": 4, "chattogeth": [4, 5], "langchain_openai": 4, "chatopenai": 4, "enum": 4, "output_pars": 4, "enumoutputpars": 4, "util": [4, 6, 7, 9, 10, 11, 12, 14], "debug_llm": 4, "extract_json": 4, "load_dotenv": [4, 5], "true": [4, 5, 6, 7, 9, 10, 11, 12, 14], "previou": [4, 7], "explor": [4, 5, 12], "inner": 4, "leverag": 4, "gener": [4, 5, 10, 11], "sequenc": 4, "through": [4, 5], "effect": [4, 12], "zero": 4, "capabl": 4, "delv": 4, "vast": 4, "arrai": [4, 8, 9, 11], "pre": [4, 6, 7, 14], "avail": [4, 5, 10, 12, 14], "courtesi": 4, "vibrant": [4, 5], "howev": [4, 5], "exhibit": 4, "remark": 4, "versatil": 4, "mai": [4, 6], "alwai": [4, 5, 7, 12, 14], "optim": [4, 6, 7, 9, 10, 11, 12, 13, 14], "domain": 4, "fine": [4, 6, 7], "tune": [4, 6, 7], "emerg": 4, "crucial": 4, "techiqu": 4, "refin": 4, "nuanc": 4, "particular": 4, "consid": [4, 5, 7], "medic": 4, "where": 4, "sole": 4, "web": 4, "struggl": 4, "perform": [4, 5, 10, 12], "out": [4, 6, 7, 8], "By": [4, 12], "corpu": 4, "literatur": 4, "its": [4, 5, 6, 12], "abil": 4, "relev": 4, "assist": 4, "extract": 4, "healthcar": 4, "significantli": [4, 12], "enhanc": 4, "convers": 4, "present": 4, "anoth": 4, "compel": 4, "case": [4, 12], "As": [4, 5, 8], "discuss": 4, "earlier": 4, "primarili": 4, "next": [4, 9, 10, 12], "token": [4, 7, 9, 11], "seamlessli": 4, "translat": 4, "engag": 4, "interact": [4, 8, 12], "contain": [4, 7], "everydai": 4, "emul": 4, "natur": 4, "flow": 4, "interfac": [4, 12], "chatgpt": 4, "primari": 4, "object": [4, 6], "establish": 4, "solid": 4, "foundat": 4, "consequ": 4, "kei": 4, "area": [4, 5], "classifi": [4, 9, 14], "encod": 4, "style": [4, 5], "decod": 4, "solv": 4, "multipl": [4, 9, 10], "singl": [4, 9, 10], "via": 4, "paramet": [4, 6, 7, 10, 11, 12, 13], "effici": [4, 12], "techniqu": [4, 12], "enabl": [4, 6, 7, 14], "smaller": 4, "gpu": [4, 6, 10, 12, 14], "reduc": [4, 12], "comput": [4, 6, 11, 12, 14], "requir": [4, 5], "dure": 4, "infer": [4, 6, 7, 9, 14], "comprehens": [4, 5], "gain": 4, "insight": 4, "tailor": 4, "excel": 4, "unleash": 4, "potenti": 4, "wide": 4, "rang": [4, 5, 6, 8, 9, 10, 13], "applic": 4, "nlp": 4, "name": [4, 7, 9, 10, 11, 12, 14], "entiti": 4, "recognit": 4, "might": [4, 5, 7, 12], "repres": 4, "easili": [4, 12], "further": 4, "metric": [4, 6, 7, 9, 11, 12, 14], "pick": [4, 12], "publicli": 4, "demonstr": [4, 9, 12], "ag": 4, "well": [4, 8], "known": [4, 5], "non": [4, 10, 12, 14], "commerci": 4, "benchmark": 4, "mine": 4, "retriev": 4, "stream": [4, 5, 6, 7, 9, 14], "know": 4, "label": [4, 6, 7, 9, 10, 11, 12, 14], "provid": 4, "120": [4, 10], "000": 4, "than": 4, "enough": 4, "4": [4, 5, 6, 7, 8, 9, 10, 11, 12, 14], "veri": 4, "littl": [4, 5, 6], "compar": [4, 5], "thousand": 4, "good": [4, 5, 12], "baselin": 4, "load_dataset": [4, 6, 7, 9, 11, 12, 14], "accuracy_metr": [4, 6, 7, 14], "load": [4, 6, 7, 11, 12, 14], "accuraci": [4, 6, 7, 9, 10, 11, 12, 14], "raw_dataset": [4, 6, 7, 14], "ag_new": [4, 6, 7, 14], "first": [4, 5, 6, 7, 12], "sampl": [4, 8], "each": [4, 5, 6, 12, 13], "dictionari": 4, "actual": 4, "articl": [4, 7], "while": [4, 5, 12], "integ": 4, "categori": 4, "correspond": 4, "accord": 4, "scheme": 4, "0": [4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14], "wall": 4, "st": 4, "bear": 4, "claw": 4, "back": [4, 5], "Into": 4, "black": 4, "reuter": 4, "short": 4, "seller": 4, "street": [4, 5], "dwindl": 4, "band": 4, "ultra": 4, "cynic": 4, "green": [4, 5], "again": 4, "featur": [4, 7, 9, 11, 12], "world": [4, 5], "sport": 4, "sci": 4, "tech": 4, "befor": 4, "era": 4, "rnn": 4, "bert": 4, "captur": 4, "mean": [4, 8, 9, 10, 11, 12, 14], "sentenc": 4, "them": [4, 6], "downstream": 4, "now": [4, 6, 7, 12, 14], "achiev": [4, 12], "But": [4, 8], "supervis": 4, "isn": 4, "onli": [4, 6, 9, 12], "option": [4, 5, 12, 14], "unsupervis": 4, "ha": [4, 5, 6], "viabl": 4, "altern": 4, "guid": [4, 8], "approach": 4, "compet": 4, "section": 4, "look": [4, 11], "explicit": 4, "creat": [4, 5, 8], "id_to_label": 4, "map": [4, 6, 7, 14], "lowercas": 4, "final": [4, 6, 7, 12], "modifi": 4, "expand": 4, "sinc": [4, 6, 7, 14], "full": [4, 5], "word": [4, 6, 7], "rather": 4, "abbrev": 4, "try": [4, 5, 6, 7], "close": 4, "initi": [4, 6, 7, 9, 12, 13, 14], "vocabulari": [4, 6, 7], "l": [4, 10, 12, 14], "lower": [4, 5, 12], "i": [4, 9, 13], "enumer": [4, 6, 9, 12], "scienc": 4, "technolog": 4, "3": [4, 5, 6, 7, 9, 10, 11, 12, 13, 14], "set": [4, 6, 7, 9, 10, 13, 14], "pipelin": 4, "add": [4, 7], "tagging_prompt": 4, "tht": 4, "construct": 4, "given": [4, 13], "batch": [4, 6, 7, 9, 10, 11, 12, 14], "save": [4, 12], "up": [4, 5, 9, 11], "cost": [4, 5], "datasetdict": [4, 6, 7, 14], "dpdf": 4, "to_panda": 4, "samples_df": 4, "groupbi": 4, "appli": [4, 12], "lambda": 4, "x": [4, 7, 10, 12, 14], "10": [4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14], "reset_index": 4, "drop": 4, "def": [4, 6, 7, 9, 10, 11, 12, 14], "get_label": 4, "str_label": 4, "return": [4, 6, 7, 9, 10, 11, 12, 14], "from_panda": 4, "tmp": [4, 12], "ipykernel_226512": 4, "1917432805": 4, "py": [4, 5, 6, 7, 10, 11, 12, 14], "deprecationwarn": 4, "dataframegroupbi": 4, "oper": [4, 11], "group": [4, 11, 13], "column": 4, "behavior": [4, 7], "deprec": [4, 7, 11, 14], "futur": [4, 11, 14], "version": [4, 6, 7, 14], "exclud": 4, "either": 4, "pass": [4, 6, 7], "include_group": 4, "fals": [4, 6, 7, 9, 10, 11, 12, 14], "explicitli": [4, 7], "select": [4, 11], "after": [4, 6, 12], "silenc": 4, "warn": [4, 7, 11, 14], "our": [4, 12], "seri": 4, "india": 4, "fire": 4, "nuclear": 4, "missil": 4, "dtype": [4, 6, 7, 14], "class": [4, 5, 10, 11, 12, 14], "inherit": 4, "pydant": [4, 5], "format": [4, 6, 7, 11, 14], "type": [4, 5, 10, 11, 12, 14], "str": [4, 14], "four": 4, "zip": 4, "count": 4, "len": [4, 6, 10, 11], "list": [4, 11, 14], "pydanticoutputpars": 4, "descript": 4, "involv": 4, "public": [4, 5], "api": [4, 7], "obtain": 4, "To": [4, 12], "process": [4, 6, 12], "bundl": 4, "request": [4, 5], "wai": 4, "instead": [4, 11, 14], "receiv": 4, "per": 4, "streamlin": 4, "addit": 4, "accommod": 4, "llama": [4, 5, 6, 7, 14], "doubt": 4, "temperatur": [4, 5], "ensur": [4, 5], "determinist": 4, "furthermor": 4, "emploi": 4, "with_structured_output": 4, "method": [4, 6], "specifi": [4, 10, 11], "parser": 4, "pydantic_object": 4, "gpt": 4, "turbo": 4, "from_templ": 4, "below": [4, 6, 7], "make": [4, 5, 6, 7, 8], "sure": [4, 6, 7, 8], "give": 4, "order": [4, 6], "number": [4, 11, 14], "respons": [4, 5], "along": [4, 5], "abov": 4, "anyth": 4, "extra": 4, "formatting_instruct": 4, "json": 4, "reject": 4, "c": [4, 5, 6, 7], "endfor": 4, "template_format": 4, "jinja2": 4, "meta": [4, 5, 6, 7, 14], "70b": 4, "chat": [4, 5], "hf": [4, 5], "max_token": 4, "1024": [4, 7], "tagging_chain": 4, "pars": 4, "string": 4, "templat": 4, "prepar": [4, 6, 14], "5": [4, 5, 8, 9, 10, 11, 12, 13, 14], "random": [4, 6, 7, 8, 10, 12, 14], "rememb": [4, 6, 12], "automat": [4, 14], "get_format_instruct": 4, "outcom": 4, "upon": 4, "examin": 4, "length": [4, 6, 11], "match": 4, "instanc": 4, "guarante": 4, "risk": 4, "product": 4, "environ": [4, 5, 14], "would": 4, "prefer": 4, "individu": 4, "post": [4, 8], "filter": 4, "empti": 4, "correctli": 4, "found": [4, 14], "amaz": 4, "right": 4, "repeat": [4, 6, 7], "huggingfaac": 4, "process_text": 4, "els": [4, 6, 7, 11, 12, 14], "r": [4, 6, 7, 10, 14], "shuffl": [4, 6, 10, 12, 14], "300": 4, "dataset_process": 4, "num_proc": 4, "batch_siz": [4, 6, 7, 9, 10, 11, 12, 14], "0x7f388b5b3b50": 4, "arrow_dataset": 4, "_map_singl": 4, "couldn": 4, "hash": 4, "wa": [4, 6, 7, 14], "serializ": 4, "pickl": 4, "dill": 4, "fingerprint": 4, "cach": [4, 7], "reus": 4, "mechan": 4, "recomput": 4, "everyth": [4, 6], "onc": [4, 12], "subsequ": 4, "failur": 4, "won": 4, "num_row": [4, 7], "save_to_disk": 4, "correct": 4, "85": 4, "total": [4, 10, 11, 12, 14], "step": [4, 6, 11, 12, 13, 14], "certain": 4, "provd": 4, "placehold": 4, "These": 4, "split": [4, 9, 12], "don": [4, 5], "cheat": 4, "record": 4, "oberv": 4, "what": [4, 5], "100": [4, 6, 8, 10, 13], "jump": 4, "87": 4, "ad": [4, 6, 7], "context": 4, "window": 4, "neg": 4, "hard": 4, "iter": [4, 9, 10, 12], "art": [4, 5], "itself": 4, "impact": [4, 12], "instantli": 4, "header": 4, "valid": [4, 9, 11, 12], "shown": [4, 12], "checkout": 4, "dspy": 4, "packag": [4, 5, 6, 7, 10, 11, 12, 14], "go": 4, "move": 4, "toward": 4, "There": [4, 6, 8], "main": [4, 6], "entir": 4, "scratch": 4, "industri": 4, "knowledg": 4, "self": [4, 6, 7, 10, 11, 12, 14], "mask": 4, "massiv": 4, "amount": 4, "signific": 4, "resourc": 4, "bloomberggpt": 4, "decad": 4, "financi": 4, "7": [4, 5, 9, 10, 11, 12, 14], "million": [4, 5], "53": [4, 10], "dai": [4, 5], "advantag": 4, "highli": 4, "lead": [4, 12], "better": [4, 12], "pretrain": [4, 10, 11], "take": [4, 5, 11, 12], "OR": 4, "less": [4, 12], "time": [4, 5, 9, 10, 11, 13], "augment": [4, 9, 10, 12], "rag": 4, "multi": [4, 6, 7, 12], "combin": 4, "strength": 4, "system": [4, 5], "incorpor": 4, "relat": 4, "simultan": 4, "share": 4, "represent": 4, "benefit": 4, "synergi": 4, "onlin": 4, "desir": 4, "embed": [4, 6, 7], "suit": [4, 5], "download": [4, 5, 7, 10, 14], "estim": [4, 10, 11, 12, 14], "size": [4, 6, 9, 10, 12, 14], "48gb": 4, "henc": 4, "imagin": 4, "teach": 4, "dog": [4, 9, 10, 12], "trick": 4, "master": 4, "basic": 4, "re": [4, 5, 12], "exist": 4, "similarli": 4, "often": [4, 5, 12], "wikipedia": 4, "entireti": 4, "internet": 4, "sentiment": 4, "analysi": 4, "summar": 4, "weight": [4, 6, 7, 9, 14], "bias": 4, "typic": [4, 12], "done": 4, "continu": 4, "rate": [4, 5, 6, 12, 13], "think": 4, "gentl": 4, "nudg": 4, "align": [4, 8], "still": 4, "intens": 4, "come": 4, "memori": [4, 5], "precis": [4, 11, 14], "bitsandbytesconfig": [4, 6, 7, 14], "automodelforsequenceclassif": [4, 6, 7, 14], "torch": [4, 6, 7, 9, 10, 11, 12, 13, 14], "quantization_config": [4, 6, 7, 14], "load_in_4bit": [4, 6, 7, 14], "bnb_4bit_quant_typ": [4, 6, 7, 14], "nf4": [4, 6, 7, 14], "bnb_4bit_use_double_qu": [4, 6, 7, 14], "bnb_4bit_compute_dtyp": [4, 6, 7, 14], "bfloat16": [4, 6, 7, 14], "model_nam": [4, 6, 7, 11, 14], "8b": [4, 5, 6, 7, 14], "from_pretrain": [4, 6, 7, 9, 14], "num_label": [4, 6, 7, 14], "device_map": 4, "auto": [4, 6, 10, 12, 14], "snippet": 4, "bit": [4, 6, 7, 14], "advanc": [4, 5], "16": [4, 5, 6, 7, 9, 10, 14], "float": [4, 11, 14], "point": [4, 11, 12], "footprint": 4, "access": 4, "deploy": 4, "constrain": 4, "devic": [4, 7, 10, 12, 14], "low": [4, 5, 6, 7, 14], "rank": [4, 6, 7, 14], "design": 4, "even": 4, "updat": [4, 6, 12], "focus": 4, "introduc": 4, "layer": [4, 6, 7, 12, 14], "showcas": 4, "configur": 4, "peft": [4, 6, 7, 14], "loraconfig": [4, 6, 7, 14], "prepare_model_for_kbit_train": [4, 6, 7, 14], "get_peft_model": [4, 6, 7, 14], "lora_config": [4, 6, 7, 14], "lora_alpha": [4, 6, 7, 14], "8": [4, 5, 6, 7, 9, 10, 11, 12, 14], "target_modul": [4, 6, 7, 14], "q_proj": [4, 6, 7, 14], "k_proj": [4, 6, 7, 14], "v_proj": [4, 6, 7, 14], "o_proj": [4, 6, 7, 14], "lora_dropout": [4, 6, 7, 14], "05": [4, 6, 7, 10, 11, 14], "bia": [4, 6, 7, 9, 14], "none": [4, 5, 6, 7, 11, 14], "task_typ": [4, 6, 7, 14], "seq_cl": [4, 6, 7, 14], "breakdown": 4, "matric": [4, 6, 7, 14], "control": [4, 7], "trainabl": [4, 10, 12, 14], "scale": [4, 6, 7, 10, 11, 14], "factor": [4, 6, 7, 13, 14], "queri": 4, "valu": [4, 11], "project": [4, 7, 12], "dropout": [4, 6, 7, 14], "prevent": 4, "overfit": 4, "24": [4, 5, 11], "hour": 4, "llama3": 4, "7b": [4, 5], "rquir": 4, "atleast": 4, "24gb": 4, "vram": 4, "big": 4, "trainingargu": [4, 6, 7, 9, 11, 14], "trainer": [4, 6, 7, 9, 10, 12, 14], "training_arg": [4, 7], "output_dir": [4, 7], "agnews_classif": [4, 7], "learning_r": [4, 6, 7, 9, 11, 12, 14], "1e": [4, 7, 11, 14], "per_device_train_batch_s": [4, 7, 9, 11], "per_device_eval_batch_s": [4, 7, 9, 11], "64": [4, 7, 9, 10, 12, 14], "num_train_epoch": [4, 7, 9, 11], "logging_step": [4, 7, 9, 11], "weight_decai": [4, 7, 9, 11, 14], "01": [4, 7, 9, 11], "evaluation_strategi": [4, 7], "epoch": [4, 6, 7, 9, 10, 11, 12, 13], "save_strategi": [4, 7, 9, 11], "load_best_model_at_end": [4, 7, 9, 11], "report_to": [4, 7], "opt": 4, "anaconda3": 4, "env": [4, 5], "nightli": 4, "lib": [4, 5, 6, 7, 10, 11, 12, 14], "python3": [4, 5, 6, 7, 10, 11, 12, 14], "site": [4, 5, 6, 7, 10, 11, 12, 14], "tqdm": [4, 5, 6], "21": [4, 5, 7, 10], "tqdmwarn": 4, "iprogress": 4, "ipywidget": 4, "readthedoc": 4, "en": 4, "stabl": [4, 12], "user_instal": 4, "autonotebook": 4, "notebook_tqdm": 4, "v4": 4, "22": 4, "been": [4, 6, 7], "migrat": 4, "old": 4, "interrupt": 4, "resum": [4, 7, 14], "later": 4, "move_cach": 4, "0it": 4, "00": [4, 5, 9, 10, 11], "1474": 4, "futurewarn": [4, 7, 14], "remov": [4, 7, 11, 14], "46": 4, "eval_strategi": [4, 9, 11], "collate_fn": [4, 6, 7, 9, 11, 12, 14], "datacollatorwithpad": [4, 6, 7, 14], "arg": [4, 6, 7, 9, 10, 11], "train_dataset": [4, 7, 9, 11], "tokenized_dataset": [4, 6, 7, 14], "eval_dataset": [4, 7, 9, 11], "data_col": [4, 7, 9, 11], "compute_metr": [4, 7, 9, 11], "train_result": [4, 7], "choic": [4, 5], "delic": 4, "balanc": 4, "between": [4, 7], "offer": [4, 5], "rapid": 4, "inexpens": 4, "suboptim": 4, "strike": 4, "middl": [4, 5], "ground": [4, 11], "boost": 4, "minim": 4, "highest": 4, "substanti": 4, "variabl": [4, 6, 7], "scarc": 4, "quick": 4, "experiment": 4, "moder": 4, "limit": [4, 14], "high": [4, 5, 12], "ampl": 4, "permit": 4, "aclantholog": 4, "2023": 4, "find": 4, "emnlp": 4, "603": 4, "pdf": 4, "collect": 5, "py3": 5, "whl": 5, "metadata": 5, "11": [5, 7, 10], "kb": 5, "satisfi": 5, "aiohttp": 5, "9": [5, 7, 9, 10, 12, 14], "conda": 5, "miniconda3": 5, "cloudspac": 5, "click": 5, "eval": [5, 6, 10, 14], "backport": 5, "eval_type_backport": 5, "filelock": 5, "13": 5, "14": 5, "numpi": [5, 6, 7, 8, 9, 10, 11, 14], "23": 5, "26": [5, 10, 11], "pillow": 5, "pyarrow": 5, "6": [5, 9, 10, 11, 12], "31": [5, 7, 14], "32": [5, 6, 7, 9, 11, 12, 14], "tabul": 5, "66": 5, "typer": 5, "12": [5, 14], "aiosign": 5, "attr": 5, "17": [5, 10], "frozenlist": 5, "multidict": 5, "yarl": 5, "async": 5, "timeout": 5, "annot": 5, "core": [5, 10, 12, 14], "18": [5, 9, 10], "charset": 5, "normal": [5, 6, 7, 9, 10, 11, 12, 14], "idna": 5, "urllib3": 5, "certifi": 5, "2017": 5, "2024": 5, "shellingham": 5, "rich": 5, "pygment": 5, "mdurl": 5, "61": 5, "2k": 5, "90m": 5, "0m": 5, "32m61": 5, "31m7": 5, "mb": [5, 10, 12, 14], "eta": 5, "36m0": 5, "25hdownload": 5, "successfulli": 5, "client": 5, "api_kei": 5, "together_api_kei": 5, "complet": [5, 11], "messag": 5, "role": 5, "user": 5, "tell": 5, "me": 5, "york": 5, "chunk": 5, "delta": 5, "end": [5, 8], "flush": 5, "citi": 5, "never": 5, "sleep": 5, "global": 5, "hub": 5, "cultur": 5, "financ": 5, "media": 5, "fashion": 5, "entertain": 5, "brief": 5, "locat": 5, "northeastern": 5, "unit": 5, "state": [5, 7, 8, 11, 12], "situat": 5, "atlant": 5, "coast": 5, "border": 5, "jersei": 5, "connecticut": 5, "west": 5, "long": 5, "island": 5, "sound": 5, "south": 5, "popul": 5, "2020": 5, "over": 5, "peopl": 5, "metropolitan": 5, "surround": 5, "counti": 5, "20": [5, 10, 11, 14], "largest": 5, "neighborhood": 5, "divid": 5, "five": 5, "borough": 5, "manhattan": 5, "brooklyn": 5, "queen": 5, "bronx": 5, "staten": 5, "uniqu": 5, "charact": 5, "famou": 5, "dens": 5, "popular": 5, "soho": 5, "houston": 5, "trendi": 5, "boutiqu": 5, "galleri": 5, "cast": 5, "iron": 5, "greenwich": 5, "villag": 5, "histor": 5, "bohemian": 5, "vibe": 5, "jazz": 5, "club": 5, "restaur": 5, "lgbtq": 5, "chinatown": 5, "itali": 5, "adjac": 5, "heritag": 5, "food": 5, "market": 5, "festiv": 5, "williamsburg": 5, "hip": 5, "thrive": 5, "music": 5, "scene": 5, "harlem": 5, "african": 5, "american": 5, "institut": 5, "landmark": 5, "home": [5, 7, 11, 12, 14], "icon": 5, "statu": 5, "liberti": 5, "elli": 5, "symbol": 5, "freedom": 5, "democraci": 5, "central": 5, "park": 5, "843": 5, "acr": 5, "oasi": 5, "walk": 5, "lake": 5, "bethesda": 5, "fountain": 5, "squar": 5, "bustl": 5, "bright": [5, 10, 11], "light": 5, "giant": 5, "billboard": 5, "live": 5, "atmospher": 5, "empir": 5, "102": 5, "stori": 5, "skyscrap": 5, "observ": [5, 12], "deck": 5, "stun": 5, "view": 5, "museum": 5, "One": 5, "cuisin": 5, "melt": 5, "pot": 5, "divers": 5, "everi": 5, "tast": 5, "budget": 5, "dish": 5, "pizza": 5, "thin": 5, "crust": 5, "foldabl": 5, "mozzarella": 5, "pepperoni": 5, "ingredi": 5, "bagel": 5, "classic": 5, "jewish": 5, "stapl": 5, "cream": 5, "chees": 5, "lox": 5, "spread": 5, "deli": 5, "sandwich": 5, "thick": 5, "cut": 5, "meat": 5, "condiment": 5, "pile": 5, "rye": 5, "bread": 5, "chines": 5, "dim": [5, 6, 10, 12], "sum": 5, "szechuan": 5, "hot": [5, 8], "eateri": 5, "katz": 5, "delicatessen": 5, "carnegi": 5, "pastrami": 5, "knish": 5, "matzo": 5, "ball": 5, "soup": 5, "artist": 5, "express": 5, "numer": 5, "venu": 5, "attract": 5, "broadwai": 5, "plai": 5, "theater": 5, "gershwin": 5, "al": 5, "hirschfeld": 5, "opera": 5, "compani": 5, "hous": 5, "philharmon": 5, "renown": 5, "orchestra": 5, "david": 5, "geffen": 5, "hall": 5, "modern": 5, "moma": 5, "contemporari": 5, "transport": 5, "subwai": 5, "network": [5, 12], "underground": 5, "train": [5, 7, 9, 10, 14], "472": 5, "station": 5, "850": 5, "mile": 5, "track": [5, 6], "buse": 5, "local": [5, 12, 14], "yellow": 5, "cab": 5, "taxi": 5, "hail": 5, "ride": 5, "servic": 5, "uber": 5, "lyft": 5, "mobil": 5, "app": 5, "weather": 5, "humid": 5, "subtrop": 5, "climat": 5, "cold": [5, 8], "winter": 5, "summer": 5, "averag": [5, 7, 10], "januari": 5, "coldest": 5, "month": 5, "around": 5, "25": 5, "f": [5, 6, 7, 9, 10, 11, 12, 14], "juli": 5, "warmest": 5, "84": [5, 10], "29": [5, 10], "expens": 5, "afford": 5, "especi": 5, "outsid": 5, "safeti": 5, "safe": 5, "crime": 5, "major": 5, "idea": [5, 12], "precaut": 5, "person": 5, "awar": 5, "avoid": [5, 6], "alon": 5, "isol": 5, "night": 5, "interest": 5, "someth": 5, "everyon": 5, "llm": 5, "mistralai": 5, "mistral": 5, "v0": 5, "m": [5, 10, 14], "fun": 5, "nyc": 5, "excit": 5, "destin": 5, "plethora": 5, "activ": [5, 6, 7, 14], "tour": 5, "visit": 5, "visitor": 5, "ferri": 5, "histori": 5, "immigr": 5, "enjoi": 5, "leisur": 5, "stroll": 5, "rent": 5, "bike": 5, "zoo": 5, "picnic": 5, "beauti": 5, "landscap": 5, "catch": 5, "ones": 5, "hamilton": 5, "lion": 5, "king": 5, "wick": 5, "finest": 5, "observatori": 5, "sunset": 5, "experi": [5, 12], "energi": 5, "crossroad": 5, "forget": 5, "pictur": 5, "year": 5, "ev": 5, "elev": 5, "former": 5, "rail": 5, "hudson": 5, "river": 5, "bridg": 5, "across": [5, 12], "suspens": 5, "panoram": 5, "pai": 5, "respect": 5, "victim": 5, "septemb": 5, "attack": 5, "event": 5, "unfold": 5, "indulg": 5, "east": 5, "side": [5, 7], "distributedtyp": 6, "dataset": [6, 7, 10, 11, 14], "load_metr": 6, "adamw": [6, 11, 14], "autotoken": [6, 7, 14], "get_linear_schedule_with_warmup": [6, 14], "set_se": 6, "functool": [6, 7, 14], "csv": [6, 7, 12, 14], "np": [6, 7, 8, 9, 10, 11, 14], "nn": [6, 7, 10, 11, 12, 13, 14], "evalu": [6, 7, 9, 12, 14], "sklearn": [6, 7, 9, 14], "make_classif": [6, 7, 14], "model_select": [6, 7, 14], "train_test_split": [6, 7, 9, 12, 14], "linear_model": [6, 7, 14], "logisticregress": [6, 7, 14], "f1_score": [6, 7, 14], "confusion_matrix": [6, 7, 9, 14], "classification_report": [6, 7, 14], "balanced_accuracy_scor": [6, 7, 14], "accuracy_scor": [6, 7, 9, 14], "add_prefix_spac": [6, 7, 14], "pad_token_id": [6, 7, 14], "eos_token_id": [6, 7, 14], "pad_token": [6, 7, 14], "eos_token": [6, 7, 14], "associ": [6, 7], "max_len": [6, 7, 14], "128": [6, 10, 11, 12], "col_to_delet": [6, 7, 14], "llama_preprocessing_funct": [6, 7, 14], "truncat": [6, 7, 14], "max_length": [6, 7, 14], "pad": [6, 14], "remove_column": [6, 14], "set_format": [6, 7, 14], "create_dataload": [6, 12, 14], "train_batch_s": [6, 12, 14], "eval_batch_s": [6, 12, 14], "train_dataload": [6, 9, 10, 12, 14], "eval_dataload": [6, 12, 14], "hyperparamet": 6, "2e": [6, 9, 14], "num_epoch": 6, "create_model": [6, 10, 11], "quantiz": [6, 7, 14], "theoret": [6, 7, 14], "distribut": [6, 7, 14], "xzibit": [6, 7, 14], "meme": [6, 7, 14], "fp": [6, 7, 14], "ml": [6, 7, 14], "dimens": [6, 7, 10, 14], "lora": [6, 7, 14], "vs": [6, 7, 14], "probabl": [6, 7, 9, 14], "wether": [6, 7, 14], "attent": [6, 7, 14], "config": [6, 7, 11, 14], "use_cach": [6, 7], "pretraining_tp": [6, 7], "training_funct": 6, "instanti": 6, "param": [6, 10, 12, 14], "unpack": 6, "gave": 6, "chang": [6, 10], "lr_schedul": [6, 11, 13], "num_warmup_step": [6, 14], "num_training_step": [6, 14], "bar": 6, "keep": [6, 8], "progress_bar": 6, "disabl": [6, 14], "is_main_process": 6, "loss": [6, 7, 9, 10, 11, 12, 14], "backward": [6, 7], "zero_grad": [6, 11], "all_predict": 6, "all_label": 6, "no_grad": [6, 10], "logit": [6, 10, 11, 12, 14], "argmax": [6, 7, 9, 11, 12, 14], "gather": 6, "tpu": [6, 10, 12, 14], "append": [6, 10, 13], "concaten": 6, "last": [6, 7, 10, 11], "element": 6, "cat": [6, 9, 10, 12, 14], "eval_metr": 6, "low_cpu_mem_usag": [6, 7, 14], "llamaforsequenceclassif": [6, 7], "were": [6, 7, 9, 14], "checkpoint": [6, 7, 9, 12, 14], "newli": [6, 7, 9, 14], "score": [6, 7], "down": [6, 7, 9, 14], "task": [6, 7, 9, 10, 14], "abl": [6, 7, 9, 14], "notebook_launch": 6, "num_process": 6, "launch": 6, "keyboardinterrupt": [6, 14], "traceback": [6, 7, 10, 11], "recent": [6, 7, 10, 11], "cell": [6, 7, 10, 11], "133": 6, "venv": [6, 7, 10, 11, 12, 14], "launcher": 6, "221": 6, "mixed_precis": 6, "use_port": 6, "master_addr": 6, "node_rank": 6, "num_nod": 6, "219": 6, "220": 6, "cpu": [6, 14], "131": [6, 10], "73": 6, "71": 6, "72": 6, "75": 6, "76": 6, "1966": [6, 7], "kwarg": [6, 7, 11], "1964": [6, 7], "scaler": [6, 7], "1965": [6, 7], "_tensor": [6, 7], "525": [6, 7], "tensor": [6, 7, 9, 10, 11, 12], "gradient": [6, 7], "retain_graph": [6, 7], "create_graph": [6, 7], "515": [6, 7], "has_torch_function_unari": [6, 7], "516": [6, 7], "handle_torch_funct": [6, 7], "517": [6, 7], "518": [6, 7], "523": [6, 7], "524": [6, 7], "autograd": [6, 7], "526": [6, 7], "527": [6, 7], "__init__": [6, 7, 10, 11, 12, 14], "267": [6, 7], "grad_tensor": [6, 7], "grad_vari": [6, 7], "262": [6, 7], "264": [6, 7], "reason": [6, 7], "comment": [6, 7], "265": [6, 7], "python": [6, 7], "266": [6, 7], "_engine_run_backward": [6, 7], "268": [6, 7], "269": [6, 7], "grad_tensors_": [6, 7], "270": [6, 7], "271": [6, 7], "272": [6, 7], "273": [6, 7], "allow_unreach": [6, 7], "274": [6, 7], "accumulate_grad": [6, 7], "275": [6, 7], "graph": [6, 7], "744": [6, 7], "t_output": [6, 7], "742": [6, 7], "unregister_hook": [6, 7], "_register_logging_hooks_on_whole_graph": [6, 7], "743": [6, 7], "_execution_engin": [6, 7], "run_backward": [6, 7], "engin": [6, 7], "745": [6, 7], "746": [6, 7], "747": [6, 7], "748": [6, 7], "attach_logging_hook": [6, 7], "pwd": 7, "puneet": [7, 11, 12, 14], "apply_llama3": [7, 12], "nb": 7, "120000": 7, "7600": 7, "compris": 7, "classif": 7, "huggingface_hub": [7, 14], "file_download": [7, 14], "1132": [7, 14], "resume_download": [7, 14], "possibl": [7, 14], "forc": [7, 14], "force_download": [7, 14], "llamamodel": 7, "embed_token": 7, "128256": 7, "4096": 7, "modulelist": 7, "llamadecoderlay": 7, "self_attn": 7, "llamasdpaattent": 7, "linear4bit": 7, "in_featur": 7, "out_featur": 7, "rotary_emb": 7, "llamarotaryembed": 7, "mlp": [7, 12], "llamamlp": 7, "gate_proj": 7, "14336": 7, "up_proj": 7, "down_proj": 7, "act_fn": 7, "silu": 7, "input_layernorm": 7, "llamarmsnorm": 7, "post_attention_layernorm": 7, "norm": 7, "linear": [7, 10, 12, 13, 14], "peftmodelforsequenceclassif": 7, "base_model": 7, "loramodel": 7, "base_lay": 7, "moduledict": 7, "p": [7, 9, 14], "inplac": 7, "lora_a": 7, "lora_b": 7, "lora_embedding_a": 7, "parameterdict": 7, "lora_embedding_b": 7, "modulestosavewrapp": 7, "original_modul": 7, "modules_to_sav": 7, "512": 7, "input_id": 7, "attention_mask": 7, "axi": [7, 9, 10, 11, 14], "balanced_accuraci": 7, "464": 7, "userwarn": [7, 11, 12, 14], "use_reentr": 7, "rais": [7, 10, 11], "except": [7, 10], "recommend": 7, "preserv": 7, "current": 7, "doc": 7, "variant": 7, "aten": 7, "src": [7, 12], "nativ": 7, "cuda": [7, 10, 12, 14], "cu": 7, "250": 7, "nll_loss_forward_reduce_cuda_kernel_2d": 7, "thread": [7, 12], "assert": 7, "n_class": 7, "fail": 7, "runtimeerror": 7, "1624": 7, "resume_from_checkpoint": [7, 11], "trial": [7, 11], "ignore_keys_for_ev": [7, 11], "1622": 7, "hf_hub_util": [7, 11], "enable_progress_bar": [7, 11], "1623": 7, "inner_training_loop": [7, 11], "1625": 7, "1626": 7, "1627": 7, "1628": 7, "1629": 7, "1961": 7, "_inner_training_loop": [7, 11], "1958": 7, "callback_handl": 7, "on_step_begin": 7, "1960": 7, "accumul": 7, "tr_loss_step": 7, "training_step": [7, 10, 12, 14], "1963": 7, "logging_nan_inf_filt": 7, "is_torch_tpu_avail": 7, "isnan": 7, "isinf": 7, "1967": 7, "1968": 7, "nan": [7, 11], "inf": 7, "simpli": 7, "log": [7, 9, 10, 12, 14], "1969": 7, "tr_loss": 7, "global_step": [7, 9, 11], "_globalstep_last_log": 7, "2911": 7, "2909": 7, "scaled_loss": 7, "2910": 7, "2913": 7, "detach": [7, 14], "gradient_accumulation_step": [7, 11], "error": 7, "trigger": 7, "asynchron": 7, "report": 7, "stacktrac": 7, "incorrect": 7, "debug": 7, "cuda_launch_block": 7, "compil": 7, "torch_use_cuda_dsa": 7, "emb": 8, "imag": [8, 9, 10, 11, 12], "etc": 8, "add_": 8, "math": 8, "begin": 8, "mbox": 8, "la_": 8, "tex": 8, "escap": 8, "dollar": 8, "sign": 8, "check": 8, "matplotlib": [8, 10, 11, 13], "rcparam": 8, "cycler": 8, "pyplot": [8, 10, 11, 13], "plt": [8, 10, 11, 13], "ion": 8, "fix": 8, "reproduc": 8, "seed": 8, "19680801": 8, "logspac": 8, "randn": 8, "ii": 8, "cmap": 8, "cm": [8, 9], "coolwarm": 8, "ax": [8, 11], "prop_cycl": 8, "color": [8, 10], "linspac": 8, "line2d": [8, 13], "custom_lin": 8, "lw": 8, "fig": [8, 12], "subplot": 8, "figsiz": 8, "plot": [8, 9, 11, 12, 13], "legend": 8, "medium": 8, "cifar10": [9, 10, 12], "portion": [9, 12], "train_d": [9, 12], "test_d": [9, 12], "5000": [9, 12], "2000": [9, 12], "test_siz": [9, 12], "val_d": [9, 12], "vitimageprocessor": 9, "processor": 9, "googl": 9, "vit": 9, "patch16": 9, "224": [9, 11], "in21k": 9, "torchvis": [9, 10, 11, 12], "centercrop": [9, 11, 12], "compos": [9, 10, 11, 12], "randomhorizontalflip": [9, 10, 11, 12], "randomresizedcrop": [9, 12], "resiz": [9, 11, 12], "totensor": [9, 10, 11, 12], "image_mean": [9, 12], "image_std": [9, 12], "height": 9, "std": [9, 11, 12], "_train_transform": [9, 12], "_val_transform": [9, 12], "train_transform": [9, 11, 12], "pixel_valu": [9, 11, 12], "rgb": [9, 11, 12], "img": [9, 10, 12], "val_transform": [9, 12], "set_transform": [9, 11, 12], "pil": [9, 10], "pngimageplugin": 9, "pngimagefil": 9, "mode": [9, 10, 12, 14], "32x32": 9, "5137": 9, "5529": 9, "4275": 9, "4431": 9, "8118": 9, "8196": 9, "1843": 9, "6000": 9, "9529": 9, "1608": 9, "5686": 9, "dataload": [9, 10, 14], "stack": [9, 10, 11, 12, 14], "k": [9, 12], "v": [9, 12], "item": [9, 10, 12], "isinst": [9, 11, 12], "shape": [9, 12], "id2label": [9, 12], "id": [9, 12], "label2id": [9, 12], "airplan": [9, 12], "automobil": [9, 12], "bird": [9, 10, 12], "deer": [9, 10, 12], "frog": [9, 10, 12], "hors": [9, 10, 12], "ship": [9, 10, 12], "truck": [9, 10, 12], "vitforimageclassif": 9, "metric_nam": 9, "cifar": [9, 12], "metric_for_best_model": [9, 11], "logging_dir": 9, "remove_unused_column": [9, 11], "fp16": [9, 11], "adamw_bnb_8bit": 9, "eval_pr": [9, 11], "dict": 9, "213": 9, "59": 9, "807600": 9, "706500": 9, "936000": 9, "420100": 9, "299821": 9, "956000": 9, "272800": 9, "187405": 9, "960000": 9, "trainoutput": [9, 11], "training_loss": [9, 11], "6544125908417322": 9, "train_runtim": [9, 11], "9173": 9, "train_samples_per_second": [9, 11], "225": [9, 11], "311": 9, "train_steps_per_second": [9, 11], "555": 9, "total_flo": [9, 11], "046216869705728e": 9, "train_loss": [9, 10, 11, 12], "test_loss": [9, 11], "1893361806869507": 9, "test_accuraci": [9, 11], "9475": 9, "test_runtim": [9, 11], "7452": 9, "test_samples_per_second": [9, 11], "534": 9, "022": 9, "test_steps_per_second": [9, 11], "822": 9, "test_time_augmented_output": 9, "tta": 9, "label_id": [9, 11], "tta_mean": 9, "9185": 9, "confusionmatrixdisplai": 9, "y_true": 9, "y_pred": 9, "disp": 9, "display_label": 9, "xticks_rot": 9, "45": [9, 11], "_plot": 9, "0x7f21f9737730": 9, "didn": 9, "much": 9, "num_work": [10, 12, 14], "int": [10, 12, 14], "cpu_count": [10, 12], "trainset": 10, "root": 10, "valset": 10, "val_dataload": [10, 12, 14], "plane": 10, "car": 10, "num_class": [10, 11], "verifi": 10, "flip": [10, 12], "w": 10, "horizont": [10, 12], "randomrot": [10, 11], "rotat": 10, "angel": 10, "randomaffin": 10, "shear": 10, "action": 10, "zoom": 10, "angl": 10, "colorjitt": [10, 11], "contrast": [10, 11], "satur": [10, 11], "comvert": 10, "491": 10, "482": 10, "446": 10, "247": 10, "243": 10, "261": 10, "imshow": 10, "unnorm": 10, "npimg": 10, "transpos": 10, "datait": 10, "make_grid": 10, "join": 10, "j": 10, "5s": 10, "torchmetr": [10, 14], "net": 10, "modul": [10, 12], "super": [10, 11, 12, 14], "conv1": 10, "conv2d": 10, "pool": 10, "maxpool2d": 10, "conv2": 10, "fc1": 10, "fc2": 10, "fc3": 10, "forward": [10, 11, 12, 14], "relu": [10, 12], "flatten": [10, 12], "timm": [10, 11], "mylitmodel": 10, "lightningmodul": [10, 12, 14], "save_hyperparamet": [10, 12, 14], "resnet18": 10, "train_accuraci": [10, 12], "multiclass": 10, "val_accuraci": [10, 12], "loss_fn": [10, 12], "crossentropyloss": [10, 11, 12], "batch_idx": [10, 12, 14], "y": [10, 12], "prog_bar": [10, 12, 14], "acc": [10, 12], "validation_step": [10, 12, 14], "val_loss": [10, 12, 14], "configure_optim": [10, 12, 14], "sgd": [10, 12, 13], "hparam": [10, 12, 14], "momentum": [10, 12], "logger": [10, 12], "tensorboardlogg": [10, 12], "callback": [10, 12], "earlystop": [10, 12], "001": [10, 11, 12], "max_epoch": [10, 12, 14], "30": [10, 11], "save_dir": [10, 12], "patienc": [10, 12], "fit": [10, 14], "hpu": [10, 12, 14], "local_rank": [10, 12, 14], "cuda_visible_devic": [10, 12, 14], "resnet": [10, 11], "multiclassaccuraci": 10, "44": 10, "727": 10, "391": 10, "07": 10, "79it": 10, "v_num": 10, "604": 10, "812": 10, "863": 10, "705": 10, "stop": [10, 12], "reach": [10, 12], "52": 10, "40it": 10, "implement": [10, 12, 14], "test_time_augment": 10, "test_dataload": 10, "num_augment": 10, "_": 10, "augmented_imag": 10, "avg_output": 10, "max": 10, "typeerror": 10, "28": [10, 11], "15": [10, 11], "95": 10, "__call__": 10, "93": 10, "94": 10, "96": 10, "137": 10, "pic": 10, "129": 10, "130": 10, "132": 10, "ndarrai": 10, "135": 10, "136": 10, "to_tensor": 10, "142": 10, "140": 10, "_log_api_usage_onc": 10, "141": 10, "f_pil": 10, "_is_pil_imag": 10, "_is_numpi": 10, "got": [10, 14], "144": 10, "_is_numpy_imag": 10, "145": 10, "valueerror": [10, 11], "dimension": 10, "ndim": 10, "frgfm": 11, "imagenett": 11, "160px": 11, "cache_dir": 11, "mnt": 11, "v2": [11, 14], "485": 11, "456": 11, "406": 11, "229": 11, "degre": 11, "test_transform": 11, "_deprec": 11, "42": 11, "releas": 11, "toimag": 11, "todtyp": 11, "float32": 11, "equival": 11, "9469": 11, "3925": 11, "pretrainedconfig": 11, "pretrainedmodel": 11, "basicblock": 11, "bottleneck": 11, "resnetconfig": 11, "model_typ": 11, "resnet50d": 11, "resnetmodelforimageclassif": 11, "criterion": 11, "eurosat": 11, "warmup_ratio": 11, "max_grad_norm": 11, "push_to_hub": 11, "dataloader_num_work": 11, "tupl": 11, "truth": 11, "mixupcallback": 11, "cutmixcallback": 11, "labelsmoothingcallback": 11, "lr_finder": [11, 12], "learningratefindercallback": 11, "trainercallback": 11, "adafactor": 11, "adafactorschedul": 11, "earlystoppingcallback": 11, "ep": [11, 14], "08": 11, "linearlr": 11, "start_factor": [11, 13], "total_it": [11, 13], "200": 11, "onecyclelr": 11, "max_lr": [11, 12], "steps_per_epoch": 11, "could": 11, "1110": 11, "41": 11, "03": 11, "83": 11, "694400": 11, "099618": 11, "354600": 11, "098599": 11, "348100": 11, "000000": 11, "005000099500000001": 11, "010000099000000002": 11, "015000098500000003": 11, "020000098000000004": 11, "025000097500000006": 11, "030000097000000003": 11, "03500009650000001": 11, "04000009600000001": 11, "04500009550000001": 11, "050000095000000015": 11, "05500009450000002": 11, "060000094000000025": 11, "06500009350000002": 11, "07000009300000003": 11, "07500009250000002": 11, "08000009200000002": 11, "08500009150000003": 11, "09000009100000003": 11, "09500009050000004": 11, "10000009000000003": 11, "10500008950000003": 11, "11000008900000004": 11, "11500008850000004": 11, "12000008800000003": 11, "12500008750000002": 11, "13000008700000004": 11, "13500008650000003": 11, "14000008600000002": 11, "14500008550000004": 11, "15000008500000006": 11, "15500008450000008": 11, "1600000840000001": 11, "1650000835000001": 11, "17000008300000008": 11, "17500008250000007": 11, "18000008200000006": 11, "18500008150000008": 11, "19000008100000007": 11, "19500008050000006": 11, "20000008000000008": 11, "2050000795000001": 11, "21000007900000012": 11, "2150000785000001": 11, "2200000780000001": 11, "2250000775000001": 11, "23000007700000008": 11, "2350000765000001": 11, "24000007600000012": 11, "24500007550000014": 11, "25000007500000015": 11, "2550000745000002": 11, "2600000740000002": 11, "2650000735000002": 11, "27000007300000023": 11, "27500007250000025": 11, "28000007200000027": 11, "28500007150000023": 11, "2900000710000002": 11, "2950000705000002": 11, "3000000700000002": 11, "3050000695000002": 11, "31000006900000016": 11, "3150000685000001": 11, "32000006800000014": 11, "32500006750000016": 11, "3300000670000002": 11, "3350000665000002": 11, "3400000660000002": 11, "34500006550000023": 11, "3500000650000002": 11, "35500006450000016": 11, "3600000640000001": 11, "36500006350000014": 11, "37000006300000016": 11, "3750000625000001": 11, "38000006200000014": 11, "3850000615000001": 11, "3900000610000001": 11, "39500006050000014": 11, "40000006000000016": 11, "4050000595000001": 11, "41000005900000014": 11, "4150000585000001": 11, "42000005800000006": 11, "4250000575000001": 11, "4300000570000001": 11, "4350000565000001": 11, "4400000560000001": 11, "4450000555000001": 11, "4500000550000001": 11, "4550000545000001": 11, "46000005400000005": 11, "46500005350000007": 11, "47000005300000003": 11, "47500005250000005": 11, "48000005200000007": 11, "4850000515000001": 11, "4900000510000001": 11, "4950000505000001": 11, "5000000500000001": 11, "5050000495000002": 11, "5100000490000002": 11, "5150000485000001": 11, "5200000480000002": 11, "5250000475000002": 11, "5300000470000003": 11, "5350000465000002": 11, "5400000460000003": 11, "5450000455000003": 11, "5500000450000002": 11, "5550000445000003": 11, "5600000440000003": 11, "5650000435000003": 11, "5700000430000003": 11, "5750000425000003": 11, "5800000420000002": 11, "5850000415000002": 11, "5900000410000001": 11, "5950000405000001": 11, "6000000400000001": 11, "6050000395": 11, "610000039": 11, "6150000385": 11, "6200000379999999": 11, "6250000374999999": 11, "630000037": 11, "6350000365": 11, "6400000360000001": 11, "6450000355000001": 11, "650000035": 11, "6550000345000001": 11, "6600000340000001": 11, "6650000335": 11, "670000033": 11, "6750000325": 11, "6800000319999999": 11, "6850000314999999": 11, "figur": 11, "1000x600": 11, "analyz": 11, "suitabl": 11, "1038630747795106": 11, "1658": 11, "6736": 11, "97": 11, "325": 11, "405405405405405": 11, "early_stopping_pati": 11, "281": 11, "56": 11, "02": [11, 12], "48": 11, "91": 11, "57": 11, "777700": 11, "947062": 11, "218089": 11, "632000": 11, "919278": 11, "280255": 11, "568100": 11, "811921": 11, "414013": 11, "201100": 11, "634535": 11, "465987": 11, "112300": 11, "365303": 11, "559490": 11, "806300": 11, "377385": 11, "572229": 11, "852700": 11, "151188": 11, "625987": 11, "36": 11, "1885": 11, "1883": 11, "1884": 11, "1886": 11, "1887": 11, "1888": 11, "1889": 11, "1890": 11, "2284": 11, "2281": 11, "optimizer_was_run": 11, "2282": 11, "delai": 11, "until": 11, "2283": 11, "reducelronplateau": 11, "2286": 11, "2287": 11, "154": 11, "lrschedul": 11, "152": 11, "153": 11, "last_epoch": [11, 13], "get_lr": 11, "155": 11, "156": 11, "epoch_deprecation_warn": 11, "1784": 11, "1781": 11, "step_num": 11, "1783": 11, "total_step": 11, "tri": 11, "1785": 11, "1787": 11, "param_group": [11, 13], "1788": 11, "start_step": 11, "280": 11, "refresh": 11, "222": 11, "43": 11, "666000": 11, "131905": 11, "247134": 11, "179900": 11, "861571": 11, "395414": 11, "991500": 11, "364271": 11, "568408": 11, "873200": 11, "050813": 11, "652484": 11, "753300": 11, "882417": 11, "717452": 11, "644200": 11, "028910": 11, "678726": 11, "1074629366934836": 11, "3073": 11, "6269": 11, "854": 11, "499": 11, "40": 11, "282": 11, "remove_callback": 11, "add_callback": 11, "1004561185836792": 11, "9681528662420382": 11, "4936": 11, "2627": 11, "935": 11, "713": 11, "deep": 12, "speed": 12, "neural": 12, "level": 12, "simplifi": 12, "covari": 12, "shift": 12, "higher": 12, "sensit": 12, "faster": 12, "converg": 12, "overal": 12, "necessari": 12, "sy": 12, "tuner": 12, "print_metr": 12, "subset": 12, "crop": 12, "simpler": 12, "appropri": 12, "worker": 12, "train_dl": [12, 14], "val_dl": 12, "perceptron": 12, "multilay": 12, "add_batchnorm": 12, "sequenti": 12, "batchnorm1d": 12, "shared_step": 12, "add_batch": 12, "csvlogger": 12, "lr_find": 12, "num_train": 12, "1000": 12, "min_lr": 12, "0001": 12, "configuration_valid": 12, "70": 12, "skip": 12, "val": 12, "loop": 12, "earli": 12, "710": 12, "due": 12, "diverg": 12, "013396766874259348": 12, "restor": 12, "lr_find_baae0e22": 12, "dbc9": 12, "4d4e": 12, "b92c": 12, "66d917f8e986": 12, "ckpt": 12, "ipykernel_71883": 12, "272602334": 12, "figurecanvasagg": 12, "thu": 12, "cannot": 12, "new_lr": 12, "199": 12, "796": 12, "log_dir": 12, "truli": 12, "twice": 12, "Then": 12, "decreas": 12, "rapidli": 12, "curv": 12, "smoother": 12, "slower": 12, "errat": 12, "ve": 12, "seen": 12, "care": 12, "benefici": 12, "vari": 12, "problem": 12, "architectur": 12, "happi": 12, "learnign": 13, "lambda1": 13, "65": 13, "lambdalr": 13, "lr_lambda": 13, "round": 13, "0x7f7c3dfc59f0": 13, "exponentiallr": 13, "gamma": 13, "0x7f7c3bd38e20": 13, "0x7f7c3bc1cbb0": 13, "tokenizers_parallel": 14, "datetim": 14, "autoconfig": 14, "619": 14, "nvml": 14, "No": 14, "runtim": 14, "cuda_hom": 14, "usr": 14, "albert": 14, "256": 14, "test_dl": 14, "create_model1": 14, "textclassifi": 14, "model_name_or_path": 14, "adam_epsilon": 14, "warmup_step": 14, "eval_split": 14, "pred": 14, "log_dict": 14, "on_training_step_end": 14, "dataloader_idx": 14, "elif": 14, "squeez": 14, "on_validation_epoch_end": 14, "warmup": 14, "decai": 14, "no_decai": 14, "layernorm": 14, "optimizer_grouped_paramet": 14, "named_paramet": 14, "nd": 14, "estimated_stepping_batch": 14, "interv": 14, "frequenc": 14, "albertforsequenceclassif": 14, "is_avail": 14, "ipython": 14, "bf16": 14, "log_every_n_step": 14, "mix": 14, "amp": 14, "588": 14, "no_deprecation_warn": 14, "215": 14, "54": 14, "detect": 14, "attempt": 14, "grace": 14, "shutdown": 14}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"apply_llama3": 0, "welcom": 1, "book": 1, "appli": 1, "llama": 1, "3": 1, "markdown": [2, 3, 8], "file": 2, "what": [2, 12], "myst": [2, 3, 8], "sampl": 2, "role": 2, "direct": 2, "citat": 2, "learn": [2, 4, 11], "more": 2, "notebook": [3, 8], "an": 3, "exampl": 3, "cell": 3, "creat": [3, 12], "quickli": 3, "add": 3, "yaml": 3, "metadata": 3, "finetun": [4, 7], "larg": [4, 7], "languag": [4, 7], "model": [4, 7, 9, 11, 12, 14], "text": 4, "classif": 4, "identifi": 4, "dataset": [4, 9, 12], "prompt": 4, "engin": 4, "invok": 4, "llm": 4, "evalu": [4, 11], "few": 4, "shot": 4, "task": 4, "transfer": 4, "background": 4, "quantiz": 4, "shrink": 4, "giant": 4, "lora": 4, "adapt": 4, "train": [4, 6, 11, 12], "comparison": 4, "refer": 4, "token": [6, 14], "dataload": [6, 12], "script": 6, "content": 8, "code": 8, "block": 8, "output": 8, "load": 9, "defin": 9, "transform": 11, "callback": 11, "trainer": 11, "rate": 11, "finder": [11, 12], "size": 11, "256": 11, "512": 11, "understand": 12, "batchnorm": 12, "pytorch": 12, "lightn": 12, "A": 12, "hand": 12, "tutori": 12, "set": 12, "up": 12, "environ": 12, "prepar": 12, "lr": [12, 13], "fit": 12, "result": 12, "With": 12, "without": 12, "compar": 12, "conclus": 12, "test": 13, "schedul": 13, "lambda": 13, "exponenti": 13, "linearlr": 13}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinxcontrib.bibtex": 9, "sphinx": 56}})